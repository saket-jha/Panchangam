<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>рд╕реВрд░реНрдпрд╕рд┐рджреНрдзрд╛рдиреНрддреАрдп рдкрдЮреНрдЪрд╛рдЩреНрдЧрдореН </title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<style>
  body{font-family:Arial,Helvetica,sans-serif;margin:30px;background:#f5f7fa;align-content: center;font-weight: bolder;}
  input,select,button{margin:6px 0;padding:8px;border:1px solid #ccc;border-radius:6px;}
  button{background:#007bff;color:#fff;cursor:pointer;}
  button:hover{background:#0056b3;}
  #result{background:#fff;border-radius:10px;padding:20px;margin-top:20px;
          box-shadow:0 0 10px rgba(0,0,0,0.1);}
  b{color:#007bff;}
</style>
<style>
  /* Initially hide the div */
  #dwivediJi {
    display: none;
    padding: 20px;
    background-color: #f0f0f0;
    border: 1px solid #ccc;
    margin-top: 10px;
    border-radius: 8px;
  }
</style>
</head>
<body>

<h1>рд╕реВрд░реНрдпрд╕рд┐рджреНрдзрд╛рдиреНрддреАрдп рдкрдЮреНрдЪрд╛рдЩреНрдЧрдореН </h1>

<label></label><br>
<input type="file" id="excelFile" accept=".xlsx,.xls" /><br>

<select id="fileLink">
  <option value="">рд╕реНрдерд╛рди рдЪреБрдиреЗрдВ</option>
  <option value="https://dl.dropboxusercontent.com/scl/fi/oid686zwco9djewl2r476/.xlsx?rlkey=n0qnnoei8dtqmvw4ebbxs8rip&st=kqv17s3q">
    рдХрд╛рд╢реА
  </option>
  <option value="https://dl.dropboxusercontent.com/scl/fi/foystnbeaarsjoe2wth6d/.xlsx?rlkey=mm9i9gecfwtyacn2s4cfsnicx&st=nfm45zkt&st=kqv17s3q">
    рдЬрдпрдкреБрд░
  </option>
</select><br><br>

<button onclick="loadFile()">рдкреБрд╖реНрдЯрд┐ рдХрд░реЗрдВ</button><br><br>

<div id="dateSection" style="display:none;">
  <label>рдЖрдЩреНрдЧреНрд▓ рджрд┐рдирд╛рдЩреНрдХ рдЪреБрдиреЗрдВ</label><br>
  <input type="date" id="datePicker" /><br><br>
  <button onclick="searchData()">рдкрдЮреНрдЪрд╛рдЩреНрдЧ</button>
</div>

<h3>Result:</h3>
<div id="result"></div>

<script>
let workbookData = null;

// Convert Excel serial or date-like string тЖТ dd/mm/yyyy
function normalizeDate(v){
  if(!v) return "";
  if(!isNaN(v)){
    const base=new Date(Date.UTC(1899,11,30));
    base.setDate(base.getDate()+Number(v));
    return base.toLocaleDateString("en-GB");
  }
  const d=new Date(v);
  if(!isNaN(d)) return d.toLocaleDateString("en-GB");
  return v.toString().trim();
}

// Convert Excel decimal тЖТ HH:MM:SS (supports >24 hrs)
function excelTimeToHMS(value){
  if(isNaN(value)) return value;
  const totalSec=Math.round(value*24*3600);
  const h=Math.floor(totalSec/3600);
  const m=Math.floor((totalSec%3600)/60);
  const s=totalSec%60;
  return `${h.toString().padStart(2,"0")}:${m.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`;
}

// Load Excel file
async function loadFile(){
  const file=document.getElementById("excelFile").files[0];
  const link=document.getElementById("fileLink").value.trim();
  const resDiv=document.getElementById("result");
  resDiv.innerHTML="тП│ рдЧрдгрдирд╛ рд╣реЛ рд░рд╣реА рд╣реИ.....";

  try{
    let buffer;
    if(file){
      buffer=await file.arrayBuffer();
    }else if(link){
      const resp=await fetch(link);
      if(!resp.ok) throw new Error("Cannot load file");
      buffer=await resp.arrayBuffer();
    }else{
      resDiv.innerHTML="тЪая╕П рдХреГрдкрдпрд╛ рдкрд╣рд▓реЗ рд╕реНрдерд╛рди рдЪреБрдиреЗрдВ";
      return;
    }

    const wb=XLSX.read(new Uint8Array(buffer),{type:"array"});
    const sh=wb.Sheets[wb.SheetNames[0]];
    workbookData=XLSX.utils.sheet_to_json(sh,{header:1,raw:true,defval:""});
    document.getElementById("dateSection").style.display="block";
    resDiv.innerHTML="тЬЕ рдХреГрдкрдпрд╛ рдЖрдЩреНрдЧреНрд▓ рджрд┐рдирд╛рдЩреНрдХ рдЪреБрдиреЗрдВ";
  }catch(err){
    console.error(err);
    resDiv.innerHTML="тЭМ рдЧрдгрдирд╛ рдХрд░рдиреЗ рдореЗрдВ рддреНрд░реБрдЯрд┐ рд╣реЛ рд░рд╣реА рд╣реИ";
  }
}

// Search data for selected date
function searchData(){
  if(!workbookData){document.getElementById("result").innerHTML="тЪая╕П Load a file first.";return;}
  const picker=document.getElementById("datePicker");
  if(!picker.value){document.getElementById("result").innerHTML="тЪая╕П Please select a date.";return;}
  const selectedDate=new Date(picker.value).toLocaleDateString("en-GB");
  const headers=workbookData[0];
  const row=workbookData.find((r,i)=>i>0 && normalizeDate(r[0])===selectedDate);
  const resDiv=document.getElementById("result");

  if(!row){resDiv.innerHTML="тЭМ рджрд┐рдирд╛рдЩреНрдХ "+selectedDate+"рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ рд╣реИ";return;}

  let out=`<b>Date:</b> ${selectedDate}<br><br>`;
  for(let i=1;i<headers.length;i++){
    const name=headers[i];
    let val=row[i];

    if(typeof val==="string" && /^\d{2,}:\d{2}(:\d{2})?$/.test(val.trim())){
      // Already formatted time
    }else if(!isNaN(val)&&val!==""){
      const num=parseFloat(val);
      if(num>=0 && num<2) val=excelTimeToHMS(num);
    }

    const varName=name.replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_]/g,"");
    window[varName]=val;
    out+=`<b>${name}:</b> <span id="${varName}">${val}</span><br>`;
  }
  resDiv.innerHTML=out;
}
</script>
<script>
  // Get elements
  const button = document.getElementById("showBtn");
  const div = document.getElementById("dwivediJi");

  // When the button is clicked тЖТ show the div
  button.addEventListener("click", () => {
    div.style.display = "block"; // or "flex" if using flexbox
  });


  var maas = 



  function show() {
    document.getElementById("dwivediJi").style.display = "block"
    document.getElementById("testing").innerText = рджрд┐рди;
  }
</script>
<!--
<button id="showBtn" onclick="show()"></button>


<div id="dwivediJi">
<p id="testing">реереР рд╢реНрд░реАрдЧрдгреЗрд╢рд╛рдп рдирдо:рее </p>
<p></p>
<p>реерд╢реНрд░реАрд╕реВрд░реНрдпрд╕рд┐рджреНрдзрд╛рдиреНрддреАрдп ЁЯМЮ рдХрд╛рд╢реАрд╕реНрде рдкрдЮреНрдЪрд╛рдЩреНрдЧрее</p>
<p></p>
<p>* рд╡рд┐рдХреНрд░рдо рд╕рдореНрд╡рдд - реирежреореи "рд╕рд┐рджреНрдзрд╛рд░реНрде рдирд╛рдордХ рд╕рдВрд╡рддреНрд╕рд░"</p>
<p>* рд╢рдХ рд╕рдореНрд╡рдд - резрепрекрен</p>
<p></p>
<p>* рдЛрддреБ    - рд╢рд░рдж </p>
<p>        </p>
<p>* рдорд╛рд╕ рд╡ рдкрдХреНрд╖ тАУ рдХрд╛рд░реНрддрд┐рдХрд╢реБрдХреНрд▓рдкрдХреНрд╖ </p>
<p></p>
<p>рд╡рд╛рд░       - рд░рд╡рд┐рд╡рд╛рд░    </p>
<p></p>
<p>рддрд┐рдерд┐    - рджреНрд╡рд╛рджрд╢реА (рд░рд╛рддреНрд░рд┐ режреж:релрем рдмрдЬреЗ рддрдХ) </p>
<p>рдирдХреНрд╖рддреНрд░    - рдкреВрд░реНрд╡рд╛рднрд╛рджреНрд░рдкрдж (резрей:рейрел рдмрдЬреЗ рддрдХ)  </p>
<p>- (рдЪрдиреНрджреНрд░рдорд╛ рдХреБрдореНрдн рд░рд╛рд╢рд┐ рдореЗрдВ рдкреНрд░рд╛рддрдГ режрен:рекрем рдмрдЬреЗ рддрдХ рддрджреБрдкрд░рд╛рдиреНрдд рдореАрди рд░рд╛рд╢рд┐ рдореЗрдВ)  </p>
<p> </p>
<p>рдХрд░рдг рез    - рдмрд╡ (резрей:рекрей рдмрдЬреЗ рддрдХ)</p>
<p>рдХрд░рдг реи    - рдмрд╛рд▓рд╡ (рд░рд╛рддреНрд░рд┐ режреж:релрем рдмрдЬреЗ рддрдХ) </p>
<p>рдХрд░рдг рей    - рдХреМрд▓рд╡ (рд╕реВрд░реНрдпреЛрджрдпрдкрд░реНрдпрдиреНрдд)</p>
<p></p>
<p>рдпреЛрдЧ      - рд╡реНрдпрд╛рдШрд╛рдд (рд░рд╛рддреНрд░рд┐ реирез:режрез рдмрдЬреЗ рддрдХ) </p>
<p>        </p>
<p>* рд╕реВрд░реНрдпреЛрджрдп    - режрем:режрео рдмрдЬреЗ </p>
<p>* рд╕реВрд░реНрдпрд╛рд╕реНрдд    - резрен:резрей рдмрдЬреЗ </p>
<p></p>
<p>* рджрд┐рд╢рд╛рд╢реВрд▓     - рдкрд╢реНрдЪрд┐рдо</p>
<p></p>
<p>рдЦреНрд░рд┐рд╖реНрдЯреАрдп рд╡рд░реНрд╖рд╛рдиреБрд╕рд╛рд░ рджрд┐рдирд╛рдВрдХ режреи рдирд╡рдореНрдмрд░ реирежреирел рдИреж</p>
<p></p>
<p>реерддрдиреНрдореЗрдордирдГ рд╢рд┐рд╡рд╕рдЩреНрдХрд▓реНрдкрдорд╕реНрддреБрее</p>
<p>***********</p>
<p>(рдХреГрдкрдпрд╛ рд╕рдордп реирек рдШрдгреНрдЯреЗ рдХреЗ рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдкреЭреЗрдВ, рдкрдЮреНрдЪрд╛рдЩреНрдЧ рдореЗрдВ рдХрд╛рд▓рдЧрдгрдирд╛ рд╕реВрд░реНрдпреЛрджрдп рдХреЗ рдкрд╢реНрдЪрд╛рдд рд╣реЛрддреА рд╣реИред)</p>
</div>

</body>
</html>
