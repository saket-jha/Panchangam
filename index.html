<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>рд╕реВрд░реНрдпрд╕рд┐рджреНрдзрд╛рдиреНрддреАрдп рдкрдЮреНрдЪрд╛рдЩреНрдЧрдореН </title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<style>
  body{margin-left: 25%; margin-right: 25%; text-align: center; font-size: larger; font-family:Arial,Helvetica,sans-serif;margin:30px;background:#f5f7fa;align-content: center;font-weight: bolder;}
  input,select,button{margin:6px 0;padding:8px;border:1px solid #ccc;border-radius:6px;}
  button{background:#007bff;color:#fff;cursor:pointer;}
  button:hover{background:#0056b3;}
  #result{background:#fff;border-radius:10px;padding:20px;margin-top:20px;
          box-shadow:0 0 10px rgba(0,0,0,0.1);}
  b{color:#007bff;}
</style>
<style>
  /* Initially hide the div */
  #dwivediJi {
    display: none;
    padding: 20px;
    background-color: #f0f0f0;
    border: 1px solid #ccc;
    margin-top: 10px;
    border-radius: 8px;
  }
</style>
</head>
<body style="margin-left: 20%; margin-right: 20%;">

<h1 style="text-align: center; font-size: larger;">рд╕реВрд░реНрдпрд╕рд┐рджреНрдзрд╛рдиреНрддреАрдп рдкрдЮреНрдЪрд╛рдЩреНрдЧрдореН </h1>

<label></label><br>
<input type="file" id="excelFile" style="font-size:xx-small; display: none;" accept=".xlsx,.xls" /><br>

<select id="fileLink">
  <option value="">рд╕реНрдерд╛рди рдЪреБрдиреЗрдВ</option>
  <option value="https://dl.dropboxusercontent.com/scl/fi/sm2li2jedmf7wyhj8ttiq/Kashi.xlsx?rlkey=d3pzcjlrsd2pazsqf8byrbyd8&st=viv5sh1t">
    рдХрд╛рд╢реА
  </option>
  <option value="https://dl.dropboxusercontent.com/scl/fi/foystnbeaarsjoe2wth6d/.xlsx?rlkey=mm9i9gecfwtyacn2s4cfsnicx&st=nfm45zkt&st=kqv17s3q">
    рдЬрдпрдкреБрд░
  </option>
</select><br><br>

<button onclick="loadFile()">рдкреБрд╖реНрдЯрд┐ рдХрд░реЗрдВ</button><br><br>

<div id="dateSection" style="display:none; text-align: center;">
  <label style="font-size: larger;">рдЖрдЩреНрдЧреНрд▓ рджрд┐рдирд╛рдЩреНрдХ рдЪреБрдиреЗрдВ</label><br>
  <input type="date" style="font-size: larger;" id="datePicker" /><br><br>
  <button onclick="searchData()" style="font-size: larger;">рдкрдЮреНрдЪрд╛рдЩреНрдЧ</button>
</div>

<h3 style="text-align: center; font-size: larger;">рдЪрдпрдирд┐рдд рджрд┐рдирд╛рдЩреНрдХ рдХрд╛ рдкрдЮреНрдЪрд╛рдЩреНрдЧ</h3>
<div id="result" style="text-align: center; font-size: larger;"></div>

<script>
let workbookData = null;

// Convert Excel serial or date-like string тЖТ dd/mm/yyyy
function normalizeDate(v){
  if(!v) return "";
  if(!isNaN(v)){
    const base=new Date(Date.UTC(1899,11,30));
    base.setDate(base.getDate()+Number(v));
    return base.toLocaleDateString("en-GB");
  }
  const d=new Date(v);
  if(!isNaN(d)) return d.toLocaleDateString("en-GB");
  return v.toString().trim();
}

// Convert Excel decimal тЖТ HH:MM:SS (supports >24 hrs)
function excelTimeToHMS(value){
  if(isNaN(value)) return value;
  const totalSec=Math.round(value*24*3600);
  const h=Math.floor(totalSec/3600);
  const m=Math.floor((totalSec%3600)/60);
  const s=totalSec%60;
  return `${h.toString().padStart(2,"0")}:${m.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`;
}

// Load Excel file
async function loadFile(){
  const file=document.getElementById("excelFile").files[0];
  const link=document.getElementById("fileLink").value.trim();
  const resDiv=document.getElementById("result");
  resDiv.innerHTML="тП│ рдЧрдгрдирд╛ рд╣реЛ рд░рд╣реА рд╣реИ.....";

  try{
    let buffer;
    if(file){
      buffer=await file.arrayBuffer();
    }else if(link){
      const resp=await fetch(link);
      if(!resp.ok) throw new Error("Cannot load file");
      buffer=await resp.arrayBuffer();
    }else{
      resDiv.innerHTML="тЪая╕П рдХреГрдкрдпрд╛ рдкрд╣рд▓реЗ рд╕реНрдерд╛рди рдЪреБрдиреЗрдВ";
      return;
    }

    const wb=XLSX.read(new Uint8Array(buffer),{type:"array"});
    const sh=wb.Sheets[wb.SheetNames[0]];
    workbookData=XLSX.utils.sheet_to_json(sh,{header:1,raw:true,defval:""});
    document.getElementById("dateSection").style.display="block";
    resDiv.innerHTML="тЬЕ рдХреГрдкрдпрд╛ рдЖрдЩреНрдЧреНрд▓ рджрд┐рдирд╛рдЩреНрдХ рдЪреБрдиреЗрдВ";
  }catch(err){
    console.error(err);
    resDiv.innerHTML="тЭМ рдЧрдгрдирд╛ рдХрд░рдиреЗ рдореЗрдВ рддреНрд░реБрдЯрд┐ рд╣реЛ рд░рд╣реА рд╣реИ";
  }
}

// Search data for selected date
function searchData(){
  if(!workbookData){document.getElementById("result").innerHTML="тЪая╕П Load a file first.";return;}
  const picker=document.getElementById("datePicker");
  if(!picker.value){document.getElementById("result").innerHTML="тЪая╕П Please select a date.";return;}
  const selectedDate=new Date(picker.value).toLocaleDateString("en-GB");
  const headers=workbookData[0];
  const row=workbookData.find((r,i)=>i>0 && normalizeDate(r[0])===selectedDate);
  const resDiv=document.getElementById("result");

  if(!row){resDiv.innerHTML="тЭМ рджрд┐рдирд╛рдЩреНрдХ "+selectedDate+"рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ рд╣реИ";return;}

  let out=`<b>Date:</b> ${selectedDate}<br><br>`;
  for(let i=1;i<headers.length;i++){
    const name=headers[i];
    let val=row[i];
//Roman to Devnagri mapping word by word:
  const dayMap = { Sun:"рд░рд╡рд┐рд╡рд╛рд░", Mon:"рд╕реЛрдорд╡рд╛рд░", Tue:"рдордЩреНрдЧрд▓рд╡рд╛рд░", Wed:"рдмреБрдзрд╡рд╛рд░", Thu:"рдмреГрд╣рд╕реНрдкрддрд┐рд╡рд╛рд░", Fri:"рд╢реБрдХреНрд░рд╡рд╛рд░", Sat:"рд╢рдирд┐рд╡рд╛рд░" };
  if(i === 2 && dayMap[val]) 
    val = dayMap[val];
  // nakshatra name mapping (if col2 has Sun/Mon etc.)
  const nakshatraMap = { "1-Ashvini": "рдЕрд╢реНрд╡рд┐рдиреА", "2-Bharani": "рднрд░рдгреА", "3-Krittik├д": "рдХреГрддреНрддрд┐рдХрд╛", "5-Mrigshir├д": "рд░реЛрд╣рд┐рдгреА", "6-├Дrdr├д": "рдореГрдЧрд╢рд┐рд░рд╛", "7-Punarvasu": "рдЖрд░реНрджреНрд░рд╛", "8-Pu┼бya": "рдкреБрдирд░реНрд╡рд╕реБ", "9-├Дshle┼б├д": "рдкреБрд╖реНрдп", "10-Magh├д": "рдЕрд╢реНрд▓реЗрд╖рд╛", "11-1Ph├дlguni": "рдордШрд╛", "12-2Ph├дlguni": "рдкреВрд░реНрд╡рд╛рдлрд╛рд▓реНрдЧреБрдиреА", "13-Hasta": "рдЙрддреНрддрд░рд╛рдлрд╛рд▓реНрдЧреБрдиреА", "14-Chitr├д": "рд╣рд╕реНрдд", "15-Sv├дti": "рдЪрд┐рддреНрд░рд╛", "15-Sv├дti": "рд╕реНрд╡рд╛рддреА", "16-Vish├дkh├д": "рд╡рд┐рд╢рд╛рдЦрд╛", "17-Anur├дdh├д": "рдЕрдиреБрд░рд╛рдзрд╛", "18-Jye┼бth├д": "рдЬреНрдпреЗрд╖реНрдард╛", "19-Moola": "рдореБрд▓", "20-1├Д┼б├дdha": "рдкреБрд░реНрд╡рд╛рд╖рд╛рдврд╛", "21-2├Д┼б├дdha": "рдЙрддреНрддрд░рд╖рд╛рдврд╛", "22-Shravana": "рд╢реНрд░рд╡рдг", "23-Dhani┼бth├д": "рдзрдирд┐рд╖реНрдард╛", "24-Shatbhi┼б": "рд╢рддрднрд┐рд╖рд╛", "25-1Bh├дdrpad": "рдкреВрд░реНрд╡рднрд╛рджреНрд░рдкрдж", "26-2Bh├дdrpad": "рдЙрддреНрддрд░рднрд╛рджреНрд░рдкрдж", "27-Revati": "рд░реЗрд╡рддреА" };
  if(i === 16 && nakshatraMap[val]) 
    val = nakshatraMap[val];

  // yog name mapping (if col5 has 01:Vi┼бkambh etc.)
  const yogMap = { "01:Vi┼бkambh": "рд╡рд┐рд╖реНрдХреБрдореНрдн", "02:Preeti": "рдкреНрд░реАрддрд┐", "03:Ayu┼бm├дn": "рдЖрдпреБрд╖реНрдорд╛рди", "04:Saubh├дgy": "рд╕реМрднрд╛рдЧреНрдп", "05:Shobhan": "рд╢реЛрднрди", "06:Atigand": "рдЕрддрд┐рдЧрдгреНрдб", "07:Sukarman": "рд╕реБрдХрд░реНрдорд╛", "08:Dhriti": "рдзреГрддрд┐", "09:Shoola": "рд╢реВрд▓", "10:Ganda": "рдЧрдгреНрдб", "11:Vriddhi": "рд╡реГрджреНрдзрд┐", "12:Dhruva": "рдзреНрд░реБрд╡", "13:Vy├дgh├дt": "рд╡реНрдпрд╛рдШрд╛рдд", "14:Har┼бan": "рд╣рд░реНрд╖рдг", "15:Vajra": "рд╡рдЬреНрд░", "16:Siddhi": "рд╕рд┐рджреНрдзрд┐", "17:Vyatip├дt": "рд╡реНрдпрддреАрдкрд╛рдд", "18:Variy├дn": "рд╡рд░реАрдпрд╛рдиреН", "19:Parigha": "рдкрд░рд┐рдШ", "20:Shiva": "рд╢рд┐рд╡", "21:Siddha": "рд╕рд┐рджреНрдз", "22:S├дdhy": "рд╕рд╛рдзреНрдп", "23:Shubha": "рд╢реБрдн", "24:Shukla": "рд╢реБрдХреНрд▓", "25:Brahma": "рдмреНрд░рд╣реНрдо", "26:Indra": "рдЗрдиреНрджреНрд░", "27:V├жdhrti": "рд╡реИрдзреГрддрд┐"};
  if(i === 5 && yogMap[val]) 
  val = yogMap[val];

 // day name mapping (if col2 has Sun/Mon etc.)
  const karanMap = { "Bava": "рдмрд╡", "B├дlav": "рдмрд╛рд▓рд╡", "Kaulav": "рдХреМрд▓рд╡", "Taitil": "рддреИрддрд┐рд▓", "Gara": "рдЧрд░", "Vanij": "рд╡рдгрд┐рдЬ", "Vi┼бti": "рд╡рд┐рд╖реНрдЯрд┐ *(рднрджреНрд░рд╛)*", "Shakun": "рд╢рдХреБрдирд┐", "Chatu┼б": "рдЪрддреБрд╖реНрдкрд╛рдж", "N├дga": "рдирд╛рдЧ", "Kimstu": "рдХрд┐рд╕реНрддреБрдШреНрди" };
  if(i === 7 && karanMap[val]) 
  val = karanMap[val];


//Roman to Devnagri mapping samapta

    // тЬЕ Step 1: Check if this is column 13 (index 12)
  if (i === 13 && String(val).trim() === "0") {
    val = "рдЕрд╣реЛрд░рд╛рддреНрд░"; // Replace directly
  }

  // тЬЕ Step 2: Handle time formatting logic for other columns
  else

    if(typeof val==="string" && /^\d{2,}:\d{2}(:\d{2})?$/.test(val.trim())){
      // Already formatted time
    }else if(!isNaN(val)&&val!==""){
      const num=parseFloat(val);
      if(num>=0 && num<2 && i !== 3) val=excelTimeToHMS(num);
    }


    const varName=name.replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_]/g,"");
    window[varName]=val;

    
    out+=`<b>${name}:</b> <span id="${varName}">${val}</span><br>`;

  }
  
  resDiv.innerHTML=out;
}
</script>
<script>
  // Get elements
  const button = document.getElementById("showBtn");
  const div = document.getElementById("dwivediJi");

  // When the button is clicked тЖТ show the div
  button.addEventListener("click", () => {
    div.style.display = "block"; // or "flex" if using flexbox
  });


  var maas = 



  function show() {
    document.getElementById("dwivediJi").style.display = "block"
    document.getElementById("testing").innerText = рджрд┐рди;
  }
</script>
<!--
<button id="showBtn" onclick="show()"></button>


<div id="dwivediJi">
<p id="testing">реереР рд╢реНрд░реАрдЧрдгреЗрд╢рд╛рдп рдирдо:рее </p>
<p></p>
<p>реерд╢реНрд░реАрд╕реВрд░реНрдпрд╕рд┐рджреНрдзрд╛рдиреНрддреАрдп ЁЯМЮ рдХрд╛рд╢реАрд╕реНрде рдкрдЮреНрдЪрд╛рдЩреНрдЧрее</p>
<p></p>
<p>* рд╡рд┐рдХреНрд░рдо рд╕рдореНрд╡рдд - реирежреореи "рд╕рд┐рджреНрдзрд╛рд░реНрде рдирд╛рдордХ рд╕рдВрд╡рддреНрд╕рд░"</p>
<p>* рд╢рдХ рд╕рдореНрд╡рдд - резрепрекрен</p>
<p></p>
<p>* рдЛрддреБ    - рд╢рд░рдж </p>
<p>        </p>
<p>* рдорд╛рд╕ рд╡ рдкрдХреНрд╖ тАУ рдХрд╛рд░реНрддрд┐рдХрд╢реБрдХреНрд▓рдкрдХреНрд╖ </p>
<p></p>
<p>рд╡рд╛рд░       - рд░рд╡рд┐рд╡рд╛рд░    </p>
<p></p>
<p>рддрд┐рдерд┐    - рджреНрд╡рд╛рджрд╢реА (рд░рд╛рддреНрд░рд┐ режреж:релрем рдмрдЬреЗ рддрдХ) </p>
<p>рдирдХреНрд╖рддреНрд░    - рдкреВрд░реНрд╡рд╛рднрд╛рджреНрд░рдкрдж (резрей:рейрел рдмрдЬреЗ рддрдХ)  </p>
<p>- (рдЪрдиреНрджреНрд░рдорд╛ рдХреБрдореНрдн рд░рд╛рд╢рд┐ рдореЗрдВ рдкреНрд░рд╛рддрдГ режрен:рекрем рдмрдЬреЗ рддрдХ рддрджреБрдкрд░рд╛рдиреНрдд рдореАрди рд░рд╛рд╢рд┐ рдореЗрдВ)  </p>
<p> </p>
<p>рдХрд░рдг рез    - рдмрд╡ (резрей:рекрей рдмрдЬреЗ рддрдХ)</p>
<p>рдХрд░рдг реи    - рдмрд╛рд▓рд╡ (рд░рд╛рддреНрд░рд┐ режреж:релрем рдмрдЬреЗ рддрдХ) </p>
<p>рдХрд░рдг рей    - рдХреМрд▓рд╡ (рд╕реВрд░реНрдпреЛрджрдпрдкрд░реНрдпрдиреНрдд)</p>
<p></p>
<p>рдпреЛрдЧ      - рд╡реНрдпрд╛рдШрд╛рдд (рд░рд╛рддреНрд░рд┐ реирез:режрез рдмрдЬреЗ рддрдХ) </p>
<p>        </p>
<p>* рд╕реВрд░реНрдпреЛрджрдп    - режрем:режрео рдмрдЬреЗ </p>
<p>* рд╕реВрд░реНрдпрд╛рд╕реНрдд    - резрен:резрей рдмрдЬреЗ </p>
<p></p>
<p>* рджрд┐рд╢рд╛рд╢реВрд▓     - рдкрд╢реНрдЪрд┐рдо</p>
<p></p>
<p>рдЦреНрд░рд┐рд╖реНрдЯреАрдп рд╡рд░реНрд╖рд╛рдиреБрд╕рд╛рд░ рджрд┐рдирд╛рдВрдХ режреи рдирд╡рдореНрдмрд░ реирежреирел рдИреж</p>
<p></p>
<p>реерддрдиреНрдореЗрдордирдГ рд╢рд┐рд╡рд╕рдЩреНрдХрд▓реНрдкрдорд╕реНрддреБрее</p>
<p>***********</p>
<p>(рдХреГрдкрдпрд╛ рд╕рдордп реирек рдШрдгреНрдЯреЗ рдХреЗ рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдкреЭреЗрдВ, рдкрдЮреНрдЪрд╛рдЩреНрдЧ рдореЗрдВ рдХрд╛рд▓рдЧрдгрдирд╛ рд╕реВрд░реНрдпреЛрджрдп рдХреЗ рдкрд╢реНрдЪрд╛рдд рд╣реЛрддреА рд╣реИред)</p>
</div>

</body>
</html>
